<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Ton Nom">
    <title>Bloc-Notes Sécurisé | Par Ton Nom</title>
    <link href="https://bootswatch.com/5/flatly/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="lockScreen">
    <div class="text-center p-5 bg-white rounded shadow-lg text-dark lock-container">
        <i data-lucide="shield-check" class="text-primary mb-3 icon-large"></i>
        <h3 id="lockTitle" data-i18n="lock_title">Coffre-fort</h3>
        <p id="lockDesc" class="small text-muted mb-4" data-i18n="lock_desc">Authentification requise.</p>
        <input type="password" id="passwordInput" class="form-control mb-3 text-center form-control-lg" placeholder="Password">
        <div id="authActions">
            <button class="btn btn-primary w-100 py-2 fw-bold" onclick="checkPassword()" data-i18n="unlock_btn">Déverrouiller</button>
        </div>
        <div id="sourceSelector" class="source-selector hidden">
            <hr>
            <p class="small fw-bold text-muted mb-3" data-i18n="source_title">DESTINATION DES DONNÉES</p>
            <button class="btn btn-outline-primary btn-sm w-100 mb-2 py-2" onclick="useStorage('local')">
                <i data-lucide="database" class="btn-icon"></i> <span data-i18n="source_local">Mémoire Navigateur</span>
            </button>
            <button class="btn btn-outline-success btn-sm w-100 py-2" onclick="useFileDirect()">
                <i data-lucide="file-json" class="btn-icon"></i> <span data-i18n="source_file">Lier un fichier JSON/Excel</span>
            </button>
        </div>
    </div>
</div>

<div class="container py-5">
    <div id="mainContent" class="row justify-content-center hidden">
        <div class="col-lg-8">
            <div class="d-flex justify-content-between align-items-center mb-5">
                <h2 class="fw-bold text-dark m-0 d-flex align-items-center">
                    <i data-lucide="notebook-pen" class="text-primary me-3 icon-header"></i>Mes Notes
                </h2>
                <div class="d-flex gap-2">
                    <button class="btn btn-sm btn-outline-secondary border-0" onclick="toggleLanguage()">
                        <i data-lucide="languages" class="btn-icon"></i> <span id="langBtnText">EN</span>
                    </button>
                    <button class="btn btn-sm btn-outline-dark border-0" onclick="toggleSettings()">
                        <i data-lucide="settings" class="btn-icon"></i> <span data-i18n="nav_security">Sécurité</span>
                    </button>
                    <button class="btn btn-sm btn-light border-0 text-muted" onclick="location.reload()">
                        <i data-lucide="log-out" class="btn-icon"></i> <span data-i18n="nav_quit">Quitter</span>
                    </button>
                </div>
            </div>

            <div id="settingsPanel" class="card shadow-sm border-0 mb-4 settings-panel">
                <div class="card-body bg-light rounded">
                    <h6 class="fw-bold text-danger mb-3"><i data-lucide="lock" class="btn-icon"></i> <span data-i18n="sec_title">Sécurité</span></h6>
                    <div class="row g-2 mb-3">
                        <div class="col-md-5"><input type="password" id="oldPass" class="form-control form-control-sm" placeholder="Ancien MDP"></div>
                        <div class="col-md-5"><input type="password" id="newPass" class="form-control form-control-sm" placeholder="Nouveau MDP"></div>
                        <div class="col-md-2"><button class="btn btn-sm btn-success w-100" onclick="updatePassword()">OK</button></div>
                    </div>
                    <button class="btn btn-sm btn-outline-danger w-100" onclick="resetApp()" data-i18n="sec_reset">Tout effacer</button>
                </div>
            </div>

            <div class="mb-4">
                <span id="modeBadge" class="badge bg-secondary mb-3 py-2 px-3 rounded-pill">...</span>
                <div class="input-group shadow-sm rounded-pill overflow-hidden bg-white search-bar">
                    <span class="input-group-text border-0 bg-white ps-3"><i data-lucide="search" class="text-muted" style="width: 16px;"></i></span>
                    <input type="text" id="searchInput" class="form-control border-0 py-2" onkeyup="filterNotes()">
                </div>
            </div>
            
            <div class="card shadow-sm border-0 mb-5">
                <div class="card-body p-4 bg-white">
                    <div class="row g-2 mb-3">
                        <div class="col-md-9">
                            <textarea id="noteInput" class="form-control border-0 bg-light p-3" rows="3" style="resize: none;" oninput="updateCharCount()"></textarea>
                            <div class="text-end small text-muted mt-1">
                                <span id="charCount">0</span> <span data-i18n="char_label">caractères</span>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="input-group mb-2">
                                <span class="input-group-text bg-light border-0"><i data-lucide="hash" style="width:14px;"></i></span>
                                <input type="text" id="tagInput" class="form-control border-0 bg-light">
                            </div>
                            <div class="color-picker-container">
                                <input type="radio" name="colorOpt" class="color-radio" value="#2c3e50" style="background-color: #2c3e50;" checked>
                                <input type="radio" name="colorOpt" class="color-radio" value="#e74c3c" style="background-color: #e74c3c;">
                                <input type="radio" name="colorOpt" class="color-radio" value="#27ae60" style="background-color: #27ae60;">
                                <input type="radio" name="colorOpt" class="color-radio" value="#f1c40f" style="background-color: #f1c40f;">
                                <input type="radio" name="colorOpt" class="color-radio" value="#3498db" style="background-color: #3498db;">
                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="btn-group">
                            <button class="btn btn-white border btn-sm text-muted" onclick="exportJSON()"><i data-lucide="file-json" class="btn-icon"></i> JSON</button>
                            <button class="btn btn-white border btn-sm text-muted" onclick="manualExport()"><i data-lucide="file-spreadsheet" class="btn-icon"></i> Excel</button>
                            <button class="btn btn-white border btn-sm text-muted" onclick="document.getElementById('quickImport').click()"><i data-lucide="upload" class="btn-icon"></i> Import</button>
                            <input type="file" id="quickImport" class="hidden" accept=".xlsx,.json" onchange="importFile(event)">
                        </div>
                        <button class="btn btn-primary px-4 py-2 shadow fw-bold" onclick="addNote()" data-i18n="btn_add">Ajouter</button>
                    </div>
                </div>
            </div>

            <div id="notesContainer"></div>

            <footer class="text-center mt-5 pb-3">
                <hr class="w-25 mx-auto opacity-25">
                <p class="text-muted small">
                    <i data-lucide="copyright" class="btn-icon" style="width: 12px;"></i> 
                    2025 - <strong>Ton Nom</strong> | <span data-i18n="footer_owner">Propriétaire & Développeur</span>
                </p>
            </footer>
        </div>
    </div>
</div>

<script src="script.js"></script>
</body>
</html>
